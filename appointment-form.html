<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Book a free consultation</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      color: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
    }
    .form-container {
      background: #fff;
      padding: 25px;
      border-radius: 10px;
      max-width: 600px;
      width: 100%;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h1 { text-align: center; margin-bottom: 10px; }
    p { text-align: center; color: #666; margin-bottom: 20px; }
    form { display: grid; gap: 15px; }
    label { font-weight: bold; margin-bottom: 5px; display: block; }
    input, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      background: #f5c542;
      border: none;
      padding: 12px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    button:disabled { background: #ddd; cursor: not-allowed; }
    .policy { font-size: 12px; color: #666; text-align: center; margin-top: 10px; }
    .alert { display: none; padding: 10px; border-radius: 6px; font-size: 14px; }
    .alert.success { background: #e6f9f0; color: #207f46; }
    .alert.error { background: #fdecea; color: #b71c1c; }
  </style>
</head>
<body>
  <div class="form-container">
    <h1>Book a free consultation</h1>
    <p>Pick a date and time that works for you. We'll confirm by email.</p>

    <div id="form-alert" class="alert" role="alert"></div>

    <form id="booking-form">
      <div>
        <label for="firstName">First name</label>
        <input id="firstName" name="firstName" type="text" required />
      </div>
      <div>
        <label for="lastName">Last name</label>
        <input id="lastName" name="lastName" type="text" required />
      </div>
      <div>
        <label for="email">Email address</label>
        <input id="email" name="email" type="email" required />
      </div>
      <div>
        <label for="phone">Call number</label>
        <input id="phone" name="phone" type="tel" required />
      </div>
      <div>
        <label for="date">Preferred date</label>
        <input id="date" name="date" type="date" required />
      </div>
      <div>
        <label for="time">Preferred time</label>
        <input id="time" name="time" type="time" required />
      </div>
      <div>
        <label for="notes">Notes (optional)</label>
        <textarea id="notes" name="notes" rows="3"></textarea>
      </div>
      <button type="submit" id="submitBtn">Book now</button>
    </form>

    <p class="policy">
      <strong>Privacy notice:</strong> By submitting this form you consent to EliteBook Solutions storing and processing your information to schedule your consultation and follow up with you. We do not sell your data. You may request deletion at any time by emailing info@elitebooksolution.com.
    </p>
  </div>

  <script>
    const API_ENDPOINT = 'http://localhost:4000/api/book';

    const dateInput = document.getElementById('date');
    dateInput.min = new Date().toISOString().split('T')[0];

    function showAlert(type, message) {
      const el = document.getElementById('form-alert');
      el.className = `alert ${type}`;
      el.textContent = message;
      el.style.display = 'block';
    }

    function clearAlert(){
      const el = document.getElementById('form-alert');
      el.style.display = 'none';
    }

    document.getElementById('booking-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      clearAlert();

      const btn = document.getElementById('submitBtn');
      btn.disabled = true;
      btn.textContent = 'Booking...';

      const payload = {
        firstName: document.getElementById('firstName').value.trim(),
        lastName: document.getElementById('lastName').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        date: document.getElementById('date').value,
        time: document.getElementById('time').value,
        notes: document.getElementById('notes').value.trim(),
      };

      try {
        const res = await fetch(API_ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (!res.ok) throw new Error(await res.text());

        showAlert('success', 'Thanks! Your request was sent. We\'ll email you shortly.');
        e.target.reset();
      } catch (err) {
        console.error(err);
        showAlert('error', 'Something went wrong sending your booking. Please try again.');
      } finally {
        btn.disabled = false;
        btn.textContent = 'Book now';
      }
    });
  </script>
</body>
</html>
